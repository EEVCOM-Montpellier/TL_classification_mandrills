End : load images
Architecture model basis
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0                                            
__________________________________________________________________________________________________
conv1/7x7_s2 (Conv2D)           (None, 112, 112, 64) 9408        input_1[0][0]                    
__________________________________________________________________________________________________
conv1/7x7_s2/bn (BatchNormaliza (None, 112, 112, 64) 256         conv1/7x7_s2[0][0]               
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           conv1/7x7_s2/bn[0][0]            
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]               
__________________________________________________________________________________________________
conv2_1_1x1_reduce (Conv2D)     (None, 55, 55, 64)   4096        max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_1_1x1_reduce/bn (BatchNor (None, 55, 55, 64)   256         conv2_1_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 64)   0           conv2_1_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv2_1_3x3 (Conv2D)            (None, 55, 55, 64)   36864       activation_2[0][0]               
__________________________________________________________________________________________________
conv2_1_3x3/bn (BatchNormalizat (None, 55, 55, 64)   256         conv2_1_3x3[0][0]                
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 64)   0           conv2_1_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv2_1_1x1_increase (Conv2D)   (None, 55, 55, 256)  16384       activation_3[0][0]               
__________________________________________________________________________________________________
conv2_1_1x1_proj (Conv2D)       (None, 55, 55, 256)  16384       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_1_1x1_increase/bn (BatchN (None, 55, 55, 256)  1024        conv2_1_1x1_increase[0][0]       
__________________________________________________________________________________________________
conv2_1_1x1_proj/bn (BatchNorma (None, 55, 55, 256)  1024        conv2_1_1x1_proj[0][0]           
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           conv2_1_1x1_increase/bn[0][0]    
                                                                 conv2_1_1x1_proj/bn[0][0]        
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2_2_1x1_reduce (Conv2D)     (None, 55, 55, 64)   16384       activation_4[0][0]               
__________________________________________________________________________________________________
conv2_2_1x1_reduce/bn (BatchNor (None, 55, 55, 64)   256         conv2_2_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 64)   0           conv2_2_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv2_2_3x3 (Conv2D)            (None, 55, 55, 64)   36864       activation_5[0][0]               
__________________________________________________________________________________________________
conv2_2_3x3/bn (BatchNormalizat (None, 55, 55, 64)   256         conv2_2_3x3[0][0]                
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 64)   0           conv2_2_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv2_2_1x1_increase (Conv2D)   (None, 55, 55, 256)  16384       activation_6[0][0]               
__________________________________________________________________________________________________
conv2_2_1x1_increase/bn (BatchN (None, 55, 55, 256)  1024        conv2_2_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           conv2_2_1x1_increase/bn[0][0]    
                                                                 activation_4[0][0]               
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2_3_1x1_reduce (Conv2D)     (None, 55, 55, 64)   16384       activation_7[0][0]               
__________________________________________________________________________________________________
conv2_3_1x1_reduce/bn (BatchNor (None, 55, 55, 64)   256         conv2_3_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 64)   0           conv2_3_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv2_3_3x3 (Conv2D)            (None, 55, 55, 64)   36864       activation_8[0][0]               
__________________________________________________________________________________________________
conv2_3_3x3/bn (BatchNormalizat (None, 55, 55, 64)   256         conv2_3_3x3[0][0]                
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 64)   0           conv2_3_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv2_3_1x1_increase (Conv2D)   (None, 55, 55, 256)  16384       activation_9[0][0]               
__________________________________________________________________________________________________
conv2_3_1x1_increase/bn (BatchN (None, 55, 55, 256)  1024        conv2_3_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           conv2_3_1x1_increase/bn[0][0]    
                                                                 activation_7[0][0]               
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]                      
__________________________________________________________________________________________________
conv3_1_1x1_reduce (Conv2D)     (None, 28, 28, 128)  32768       activation_10[0][0]              
__________________________________________________________________________________________________
conv3_1_1x1_reduce/bn (BatchNor (None, 28, 28, 128)  512         conv3_1_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 128)  0           conv3_1_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv3_1_3x3 (Conv2D)            (None, 28, 28, 128)  147456      activation_11[0][0]              
__________________________________________________________________________________________________
conv3_1_3x3/bn (BatchNormalizat (None, 28, 28, 128)  512         conv3_1_3x3[0][0]                
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 128)  0           conv3_1_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv3_1_1x1_increase (Conv2D)   (None, 28, 28, 512)  65536       activation_12[0][0]              
__________________________________________________________________________________________________
conv3_1_1x1_proj (Conv2D)       (None, 28, 28, 512)  131072      activation_10[0][0]              
__________________________________________________________________________________________________
conv3_1_1x1_increase/bn (BatchN (None, 28, 28, 512)  2048        conv3_1_1x1_increase[0][0]       
__________________________________________________________________________________________________
conv3_1_1x1_proj/bn (BatchNorma (None, 28, 28, 512)  2048        conv3_1_1x1_proj[0][0]           
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           conv3_1_1x1_increase/bn[0][0]    
                                                                 conv3_1_1x1_proj/bn[0][0]        
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]                      
__________________________________________________________________________________________________
conv3_2_1x1_reduce (Conv2D)     (None, 28, 28, 128)  65536       activation_13[0][0]              
__________________________________________________________________________________________________
conv3_2_1x1_reduce/bn (BatchNor (None, 28, 28, 128)  512         conv3_2_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 128)  0           conv3_2_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv3_2_3x3 (Conv2D)            (None, 28, 28, 128)  147456      activation_14[0][0]              
__________________________________________________________________________________________________
conv3_2_3x3/bn (BatchNormalizat (None, 28, 28, 128)  512         conv3_2_3x3[0][0]                
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 128)  0           conv3_2_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv3_2_1x1_increase (Conv2D)   (None, 28, 28, 512)  65536       activation_15[0][0]              
__________________________________________________________________________________________________
conv3_2_1x1_increase/bn (BatchN (None, 28, 28, 512)  2048        conv3_2_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           conv3_2_1x1_increase/bn[0][0]    
                                                                 activation_13[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]                      
__________________________________________________________________________________________________
conv3_3_1x1_reduce (Conv2D)     (None, 28, 28, 128)  65536       activation_16[0][0]              
__________________________________________________________________________________________________
conv3_3_1x1_reduce/bn (BatchNor (None, 28, 28, 128)  512         conv3_3_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 128)  0           conv3_3_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv3_3_3x3 (Conv2D)            (None, 28, 28, 128)  147456      activation_17[0][0]              
__________________________________________________________________________________________________
conv3_3_3x3/bn (BatchNormalizat (None, 28, 28, 128)  512         conv3_3_3x3[0][0]                
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 128)  0           conv3_3_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv3_3_1x1_increase (Conv2D)   (None, 28, 28, 512)  65536       activation_18[0][0]              
__________________________________________________________________________________________________
conv3_3_1x1_increase/bn (BatchN (None, 28, 28, 512)  2048        conv3_3_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           conv3_3_1x1_increase/bn[0][0]    
                                                                 activation_16[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]                      
__________________________________________________________________________________________________
conv3_4_1x1_reduce (Conv2D)     (None, 28, 28, 128)  65536       activation_19[0][0]              
__________________________________________________________________________________________________
conv3_4_1x1_reduce/bn (BatchNor (None, 28, 28, 128)  512         conv3_4_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 128)  0           conv3_4_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv3_4_3x3 (Conv2D)            (None, 28, 28, 128)  147456      activation_20[0][0]              
__________________________________________________________________________________________________
conv3_4_3x3/bn (BatchNormalizat (None, 28, 28, 128)  512         conv3_4_3x3[0][0]                
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 128)  0           conv3_4_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv3_4_1x1_increase (Conv2D)   (None, 28, 28, 512)  65536       activation_21[0][0]              
__________________________________________________________________________________________________
conv3_4_1x1_increase/bn (BatchN (None, 28, 28, 512)  2048        conv3_4_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           conv3_4_1x1_increase/bn[0][0]    
                                                                 activation_19[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]                      
__________________________________________________________________________________________________
conv4_1_1x1_reduce (Conv2D)     (None, 14, 14, 256)  131072      activation_22[0][0]              
__________________________________________________________________________________________________
conv4_1_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_1_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 256)  0           conv4_1_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_1_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_23[0][0]              
__________________________________________________________________________________________________
conv4_1_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_1_3x3[0][0]                
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 256)  0           conv4_1_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_1_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_24[0][0]              
__________________________________________________________________________________________________
conv4_1_1x1_proj (Conv2D)       (None, 14, 14, 1024) 524288      activation_22[0][0]              
__________________________________________________________________________________________________
conv4_1_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_1_1x1_increase[0][0]       
__________________________________________________________________________________________________
conv4_1_1x1_proj/bn (BatchNorma (None, 14, 14, 1024) 4096        conv4_1_1x1_proj[0][0]           
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           conv4_1_1x1_increase/bn[0][0]    
                                                                 conv4_1_1x1_proj/bn[0][0]        
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]                      
__________________________________________________________________________________________________
conv4_2_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_25[0][0]              
__________________________________________________________________________________________________
conv4_2_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_2_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 256)  0           conv4_2_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_2_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_26[0][0]              
__________________________________________________________________________________________________
conv4_2_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_2_3x3[0][0]                
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 256)  0           conv4_2_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_2_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_27[0][0]              
__________________________________________________________________________________________________
conv4_2_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_2_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           conv4_2_1x1_increase/bn[0][0]    
                                                                 activation_25[0][0]              
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 1024) 0           add_9[0][0]                      
__________________________________________________________________________________________________
conv4_3_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_28[0][0]              
__________________________________________________________________________________________________
conv4_3_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_3_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 256)  0           conv4_3_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_3_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_29[0][0]              
__________________________________________________________________________________________________
conv4_3_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_3_3x3[0][0]                
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 256)  0           conv4_3_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_3_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_30[0][0]              
__________________________________________________________________________________________________
conv4_3_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_3_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           conv4_3_1x1_increase/bn[0][0]    
                                                                 activation_28[0][0]              
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 1024) 0           add_10[0][0]                     
__________________________________________________________________________________________________
conv4_4_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_31[0][0]              
__________________________________________________________________________________________________
conv4_4_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_4_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 256)  0           conv4_4_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_4_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_32[0][0]              
__________________________________________________________________________________________________
conv4_4_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_4_3x3[0][0]                
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 256)  0           conv4_4_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_4_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_33[0][0]              
__________________________________________________________________________________________________
conv4_4_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_4_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           conv4_4_1x1_increase/bn[0][0]    
                                                                 activation_31[0][0]              
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 1024) 0           add_11[0][0]                     
__________________________________________________________________________________________________
conv4_5_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_34[0][0]              
__________________________________________________________________________________________________
conv4_5_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_5_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 256)  0           conv4_5_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_5_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_35[0][0]              
__________________________________________________________________________________________________
conv4_5_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_5_3x3[0][0]                
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 256)  0           conv4_5_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_5_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_36[0][0]              
__________________________________________________________________________________________________
conv4_5_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_5_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           conv4_5_1x1_increase/bn[0][0]    
                                                                 activation_34[0][0]              
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 1024) 0           add_12[0][0]                     
__________________________________________________________________________________________________
conv4_6_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_37[0][0]              
__________________________________________________________________________________________________
conv4_6_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_6_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 256)  0           conv4_6_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_6_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_38[0][0]              
__________________________________________________________________________________________________
conv4_6_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_6_3x3[0][0]                
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 256)  0           conv4_6_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_6_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_39[0][0]              
__________________________________________________________________________________________________
conv4_6_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_6_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           conv4_6_1x1_increase/bn[0][0]    
                                                                 activation_37[0][0]              
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 1024) 0           add_13[0][0]                     
__________________________________________________________________________________________________
conv5_1_1x1_reduce (Conv2D)     (None, 7, 7, 512)    524288      activation_40[0][0]              
__________________________________________________________________________________________________
conv5_1_1x1_reduce/bn (BatchNor (None, 7, 7, 512)    2048        conv5_1_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 512)    0           conv5_1_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv5_1_3x3 (Conv2D)            (None, 7, 7, 512)    2359296     activation_41[0][0]              
__________________________________________________________________________________________________
conv5_1_3x3/bn (BatchNormalizat (None, 7, 7, 512)    2048        conv5_1_3x3[0][0]                
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 512)    0           conv5_1_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv5_1_1x1_increase (Conv2D)   (None, 7, 7, 2048)   1048576     activation_42[0][0]              
__________________________________________________________________________________________________
conv5_1_1x1_proj (Conv2D)       (None, 7, 7, 2048)   2097152     activation_40[0][0]              
__________________________________________________________________________________________________
conv5_1_1x1_increase/bn (BatchN (None, 7, 7, 2048)   8192        conv5_1_1x1_increase[0][0]       
__________________________________________________________________________________________________
conv5_1_1x1_proj/bn (BatchNorma (None, 7, 7, 2048)   8192        conv5_1_1x1_proj[0][0]           
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           conv5_1_1x1_increase/bn[0][0]    
                                                                 conv5_1_1x1_proj/bn[0][0]        
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv5_2_1x1_reduce (Conv2D)     (None, 7, 7, 512)    1048576     activation_43[0][0]              
__________________________________________________________________________________________________
conv5_2_1x1_reduce/bn (BatchNor (None, 7, 7, 512)    2048        conv5_2_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 512)    0           conv5_2_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv5_2_3x3 (Conv2D)            (None, 7, 7, 512)    2359296     activation_44[0][0]              
__________________________________________________________________________________________________
conv5_2_3x3/bn (BatchNormalizat (None, 7, 7, 512)    2048        conv5_2_3x3[0][0]                
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 512)    0           conv5_2_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv5_2_1x1_increase (Conv2D)   (None, 7, 7, 2048)   1048576     activation_45[0][0]              
__________________________________________________________________________________________________
conv5_2_1x1_increase/bn (BatchN (None, 7, 7, 2048)   8192        conv5_2_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           conv5_2_1x1_increase/bn[0][0]    
                                                                 activation_43[0][0]              
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 2048)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv5_3_1x1_reduce (Conv2D)     (None, 7, 7, 512)    1048576     activation_46[0][0]              
__________________________________________________________________________________________________
conv5_3_1x1_reduce/bn (BatchNor (None, 7, 7, 512)    2048        conv5_3_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 512)    0           conv5_3_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv5_3_3x3 (Conv2D)            (None, 7, 7, 512)    2359296     activation_47[0][0]              
__________________________________________________________________________________________________
conv5_3_3x3/bn (BatchNormalizat (None, 7, 7, 512)    2048        conv5_3_3x3[0][0]                
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 512)    0           conv5_3_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv5_3_1x1_increase (Conv2D)   (None, 7, 7, 2048)   1048576     activation_48[0][0]              
__________________________________________________________________________________________________
conv5_3_1x1_increase/bn (BatchN (None, 7, 7, 2048)   8192        conv5_3_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           conv5_3_1x1_increase/bn[0][0]    
                                                                 activation_46[0][0]              
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 2048)   0           add_16[0][0]                     
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           activation_49[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]                   
__________________________________________________________________________________________________
classifier (Dense)              (None, 8631)         17684919    flatten_1[0][0]                  
==================================================================================================
Total params: 41,246,071
Trainable params: 41,192,951
Non-trainable params: 53,120
__________________________________________________________________________________________________
None
End: Split dataset into train et test set
Architecture custom
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 224, 224, 3)  0                                            
__________________________________________________________________________________________________
conv1/7x7_s2 (Conv2D)           (None, 112, 112, 64) 9408        input_1[0][0]                    
__________________________________________________________________________________________________
conv1/7x7_s2/bn (BatchNormaliza (None, 112, 112, 64) 256         conv1/7x7_s2[0][0]               
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 112, 112, 64) 0           conv1/7x7_s2/bn[0][0]            
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 55, 55, 64)   0           activation_1[0][0]               
__________________________________________________________________________________________________
conv2_1_1x1_reduce (Conv2D)     (None, 55, 55, 64)   4096        max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_1_1x1_reduce/bn (BatchNor (None, 55, 55, 64)   256         conv2_1_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_2 (Activation)       (None, 55, 55, 64)   0           conv2_1_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv2_1_3x3 (Conv2D)            (None, 55, 55, 64)   36864       activation_2[0][0]               
__________________________________________________________________________________________________
conv2_1_3x3/bn (BatchNormalizat (None, 55, 55, 64)   256         conv2_1_3x3[0][0]                
__________________________________________________________________________________________________
activation_3 (Activation)       (None, 55, 55, 64)   0           conv2_1_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv2_1_1x1_increase (Conv2D)   (None, 55, 55, 256)  16384       activation_3[0][0]               
__________________________________________________________________________________________________
conv2_1_1x1_proj (Conv2D)       (None, 55, 55, 256)  16384       max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_1_1x1_increase/bn (BatchN (None, 55, 55, 256)  1024        conv2_1_1x1_increase[0][0]       
__________________________________________________________________________________________________
conv2_1_1x1_proj/bn (BatchNorma (None, 55, 55, 256)  1024        conv2_1_1x1_proj[0][0]           
__________________________________________________________________________________________________
add_1 (Add)                     (None, 55, 55, 256)  0           conv2_1_1x1_increase/bn[0][0]    
                                                                 conv2_1_1x1_proj/bn[0][0]        
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 55, 55, 256)  0           add_1[0][0]                      
__________________________________________________________________________________________________
conv2_2_1x1_reduce (Conv2D)     (None, 55, 55, 64)   16384       activation_4[0][0]               
__________________________________________________________________________________________________
conv2_2_1x1_reduce/bn (BatchNor (None, 55, 55, 64)   256         conv2_2_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 55, 55, 64)   0           conv2_2_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv2_2_3x3 (Conv2D)            (None, 55, 55, 64)   36864       activation_5[0][0]               
__________________________________________________________________________________________________
conv2_2_3x3/bn (BatchNormalizat (None, 55, 55, 64)   256         conv2_2_3x3[0][0]                
__________________________________________________________________________________________________
activation_6 (Activation)       (None, 55, 55, 64)   0           conv2_2_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv2_2_1x1_increase (Conv2D)   (None, 55, 55, 256)  16384       activation_6[0][0]               
__________________________________________________________________________________________________
conv2_2_1x1_increase/bn (BatchN (None, 55, 55, 256)  1024        conv2_2_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_2 (Add)                     (None, 55, 55, 256)  0           conv2_2_1x1_increase/bn[0][0]    
                                                                 activation_4[0][0]               
__________________________________________________________________________________________________
activation_7 (Activation)       (None, 55, 55, 256)  0           add_2[0][0]                      
__________________________________________________________________________________________________
conv2_3_1x1_reduce (Conv2D)     (None, 55, 55, 64)   16384       activation_7[0][0]               
__________________________________________________________________________________________________
conv2_3_1x1_reduce/bn (BatchNor (None, 55, 55, 64)   256         conv2_3_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_8 (Activation)       (None, 55, 55, 64)   0           conv2_3_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv2_3_3x3 (Conv2D)            (None, 55, 55, 64)   36864       activation_8[0][0]               
__________________________________________________________________________________________________
conv2_3_3x3/bn (BatchNormalizat (None, 55, 55, 64)   256         conv2_3_3x3[0][0]                
__________________________________________________________________________________________________
activation_9 (Activation)       (None, 55, 55, 64)   0           conv2_3_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv2_3_1x1_increase (Conv2D)   (None, 55, 55, 256)  16384       activation_9[0][0]               
__________________________________________________________________________________________________
conv2_3_1x1_increase/bn (BatchN (None, 55, 55, 256)  1024        conv2_3_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_3 (Add)                     (None, 55, 55, 256)  0           conv2_3_1x1_increase/bn[0][0]    
                                                                 activation_7[0][0]               
__________________________________________________________________________________________________
activation_10 (Activation)      (None, 55, 55, 256)  0           add_3[0][0]                      
__________________________________________________________________________________________________
conv3_1_1x1_reduce (Conv2D)     (None, 28, 28, 128)  32768       activation_10[0][0]              
__________________________________________________________________________________________________
conv3_1_1x1_reduce/bn (BatchNor (None, 28, 28, 128)  512         conv3_1_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_11 (Activation)      (None, 28, 28, 128)  0           conv3_1_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv3_1_3x3 (Conv2D)            (None, 28, 28, 128)  147456      activation_11[0][0]              
__________________________________________________________________________________________________
conv3_1_3x3/bn (BatchNormalizat (None, 28, 28, 128)  512         conv3_1_3x3[0][0]                
__________________________________________________________________________________________________
activation_12 (Activation)      (None, 28, 28, 128)  0           conv3_1_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv3_1_1x1_increase (Conv2D)   (None, 28, 28, 512)  65536       activation_12[0][0]              
__________________________________________________________________________________________________
conv3_1_1x1_proj (Conv2D)       (None, 28, 28, 512)  131072      activation_10[0][0]              
__________________________________________________________________________________________________
conv3_1_1x1_increase/bn (BatchN (None, 28, 28, 512)  2048        conv3_1_1x1_increase[0][0]       
__________________________________________________________________________________________________
conv3_1_1x1_proj/bn (BatchNorma (None, 28, 28, 512)  2048        conv3_1_1x1_proj[0][0]           
__________________________________________________________________________________________________
add_4 (Add)                     (None, 28, 28, 512)  0           conv3_1_1x1_increase/bn[0][0]    
                                                                 conv3_1_1x1_proj/bn[0][0]        
__________________________________________________________________________________________________
activation_13 (Activation)      (None, 28, 28, 512)  0           add_4[0][0]                      
__________________________________________________________________________________________________
conv3_2_1x1_reduce (Conv2D)     (None, 28, 28, 128)  65536       activation_13[0][0]              
__________________________________________________________________________________________________
conv3_2_1x1_reduce/bn (BatchNor (None, 28, 28, 128)  512         conv3_2_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_14 (Activation)      (None, 28, 28, 128)  0           conv3_2_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv3_2_3x3 (Conv2D)            (None, 28, 28, 128)  147456      activation_14[0][0]              
__________________________________________________________________________________________________
conv3_2_3x3/bn (BatchNormalizat (None, 28, 28, 128)  512         conv3_2_3x3[0][0]                
__________________________________________________________________________________________________
activation_15 (Activation)      (None, 28, 28, 128)  0           conv3_2_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv3_2_1x1_increase (Conv2D)   (None, 28, 28, 512)  65536       activation_15[0][0]              
__________________________________________________________________________________________________
conv3_2_1x1_increase/bn (BatchN (None, 28, 28, 512)  2048        conv3_2_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_5 (Add)                     (None, 28, 28, 512)  0           conv3_2_1x1_increase/bn[0][0]    
                                                                 activation_13[0][0]              
__________________________________________________________________________________________________
activation_16 (Activation)      (None, 28, 28, 512)  0           add_5[0][0]                      
__________________________________________________________________________________________________
conv3_3_1x1_reduce (Conv2D)     (None, 28, 28, 128)  65536       activation_16[0][0]              
__________________________________________________________________________________________________
conv3_3_1x1_reduce/bn (BatchNor (None, 28, 28, 128)  512         conv3_3_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_17 (Activation)      (None, 28, 28, 128)  0           conv3_3_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv3_3_3x3 (Conv2D)            (None, 28, 28, 128)  147456      activation_17[0][0]              
__________________________________________________________________________________________________
conv3_3_3x3/bn (BatchNormalizat (None, 28, 28, 128)  512         conv3_3_3x3[0][0]                
__________________________________________________________________________________________________
activation_18 (Activation)      (None, 28, 28, 128)  0           conv3_3_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv3_3_1x1_increase (Conv2D)   (None, 28, 28, 512)  65536       activation_18[0][0]              
__________________________________________________________________________________________________
conv3_3_1x1_increase/bn (BatchN (None, 28, 28, 512)  2048        conv3_3_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_6 (Add)                     (None, 28, 28, 512)  0           conv3_3_1x1_increase/bn[0][0]    
                                                                 activation_16[0][0]              
__________________________________________________________________________________________________
activation_19 (Activation)      (None, 28, 28, 512)  0           add_6[0][0]                      
__________________________________________________________________________________________________
conv3_4_1x1_reduce (Conv2D)     (None, 28, 28, 128)  65536       activation_19[0][0]              
__________________________________________________________________________________________________
conv3_4_1x1_reduce/bn (BatchNor (None, 28, 28, 128)  512         conv3_4_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_20 (Activation)      (None, 28, 28, 128)  0           conv3_4_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv3_4_3x3 (Conv2D)            (None, 28, 28, 128)  147456      activation_20[0][0]              
__________________________________________________________________________________________________
conv3_4_3x3/bn (BatchNormalizat (None, 28, 28, 128)  512         conv3_4_3x3[0][0]                
__________________________________________________________________________________________________
activation_21 (Activation)      (None, 28, 28, 128)  0           conv3_4_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv3_4_1x1_increase (Conv2D)   (None, 28, 28, 512)  65536       activation_21[0][0]              
__________________________________________________________________________________________________
conv3_4_1x1_increase/bn (BatchN (None, 28, 28, 512)  2048        conv3_4_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_7 (Add)                     (None, 28, 28, 512)  0           conv3_4_1x1_increase/bn[0][0]    
                                                                 activation_19[0][0]              
__________________________________________________________________________________________________
activation_22 (Activation)      (None, 28, 28, 512)  0           add_7[0][0]                      
__________________________________________________________________________________________________
conv4_1_1x1_reduce (Conv2D)     (None, 14, 14, 256)  131072      activation_22[0][0]              
__________________________________________________________________________________________________
conv4_1_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_1_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_23 (Activation)      (None, 14, 14, 256)  0           conv4_1_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_1_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_23[0][0]              
__________________________________________________________________________________________________
conv4_1_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_1_3x3[0][0]                
__________________________________________________________________________________________________
activation_24 (Activation)      (None, 14, 14, 256)  0           conv4_1_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_1_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_24[0][0]              
__________________________________________________________________________________________________
conv4_1_1x1_proj (Conv2D)       (None, 14, 14, 1024) 524288      activation_22[0][0]              
__________________________________________________________________________________________________
conv4_1_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_1_1x1_increase[0][0]       
__________________________________________________________________________________________________
conv4_1_1x1_proj/bn (BatchNorma (None, 14, 14, 1024) 4096        conv4_1_1x1_proj[0][0]           
__________________________________________________________________________________________________
add_8 (Add)                     (None, 14, 14, 1024) 0           conv4_1_1x1_increase/bn[0][0]    
                                                                 conv4_1_1x1_proj/bn[0][0]        
__________________________________________________________________________________________________
activation_25 (Activation)      (None, 14, 14, 1024) 0           add_8[0][0]                      
__________________________________________________________________________________________________
conv4_2_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_25[0][0]              
__________________________________________________________________________________________________
conv4_2_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_2_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_26 (Activation)      (None, 14, 14, 256)  0           conv4_2_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_2_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_26[0][0]              
__________________________________________________________________________________________________
conv4_2_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_2_3x3[0][0]                
__________________________________________________________________________________________________
activation_27 (Activation)      (None, 14, 14, 256)  0           conv4_2_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_2_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_27[0][0]              
__________________________________________________________________________________________________
conv4_2_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_2_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_9 (Add)                     (None, 14, 14, 1024) 0           conv4_2_1x1_increase/bn[0][0]    
                                                                 activation_25[0][0]              
__________________________________________________________________________________________________
activation_28 (Activation)      (None, 14, 14, 1024) 0           add_9[0][0]                      
__________________________________________________________________________________________________
conv4_3_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_28[0][0]              
__________________________________________________________________________________________________
conv4_3_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_3_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_29 (Activation)      (None, 14, 14, 256)  0           conv4_3_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_3_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_29[0][0]              
__________________________________________________________________________________________________
conv4_3_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_3_3x3[0][0]                
__________________________________________________________________________________________________
activation_30 (Activation)      (None, 14, 14, 256)  0           conv4_3_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_3_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_30[0][0]              
__________________________________________________________________________________________________
conv4_3_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_3_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_10 (Add)                    (None, 14, 14, 1024) 0           conv4_3_1x1_increase/bn[0][0]    
                                                                 activation_28[0][0]              
__________________________________________________________________________________________________
activation_31 (Activation)      (None, 14, 14, 1024) 0           add_10[0][0]                     
__________________________________________________________________________________________________
conv4_4_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_31[0][0]              
__________________________________________________________________________________________________
conv4_4_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_4_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_32 (Activation)      (None, 14, 14, 256)  0           conv4_4_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_4_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_32[0][0]              
__________________________________________________________________________________________________
conv4_4_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_4_3x3[0][0]                
__________________________________________________________________________________________________
activation_33 (Activation)      (None, 14, 14, 256)  0           conv4_4_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_4_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_33[0][0]              
__________________________________________________________________________________________________
conv4_4_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_4_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_11 (Add)                    (None, 14, 14, 1024) 0           conv4_4_1x1_increase/bn[0][0]    
                                                                 activation_31[0][0]              
__________________________________________________________________________________________________
activation_34 (Activation)      (None, 14, 14, 1024) 0           add_11[0][0]                     
__________________________________________________________________________________________________
conv4_5_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_34[0][0]              
__________________________________________________________________________________________________
conv4_5_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_5_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_35 (Activation)      (None, 14, 14, 256)  0           conv4_5_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_5_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_35[0][0]              
__________________________________________________________________________________________________
conv4_5_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_5_3x3[0][0]                
__________________________________________________________________________________________________
activation_36 (Activation)      (None, 14, 14, 256)  0           conv4_5_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_5_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_36[0][0]              
__________________________________________________________________________________________________
conv4_5_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_5_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_12 (Add)                    (None, 14, 14, 1024) 0           conv4_5_1x1_increase/bn[0][0]    
                                                                 activation_34[0][0]              
__________________________________________________________________________________________________
activation_37 (Activation)      (None, 14, 14, 1024) 0           add_12[0][0]                     
__________________________________________________________________________________________________
conv4_6_1x1_reduce (Conv2D)     (None, 14, 14, 256)  262144      activation_37[0][0]              
__________________________________________________________________________________________________
conv4_6_1x1_reduce/bn (BatchNor (None, 14, 14, 256)  1024        conv4_6_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_38 (Activation)      (None, 14, 14, 256)  0           conv4_6_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv4_6_3x3 (Conv2D)            (None, 14, 14, 256)  589824      activation_38[0][0]              
__________________________________________________________________________________________________
conv4_6_3x3/bn (BatchNormalizat (None, 14, 14, 256)  1024        conv4_6_3x3[0][0]                
__________________________________________________________________________________________________
activation_39 (Activation)      (None, 14, 14, 256)  0           conv4_6_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv4_6_1x1_increase (Conv2D)   (None, 14, 14, 1024) 262144      activation_39[0][0]              
__________________________________________________________________________________________________
conv4_6_1x1_increase/bn (BatchN (None, 14, 14, 1024) 4096        conv4_6_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_13 (Add)                    (None, 14, 14, 1024) 0           conv4_6_1x1_increase/bn[0][0]    
                                                                 activation_37[0][0]              
__________________________________________________________________________________________________
activation_40 (Activation)      (None, 14, 14, 1024) 0           add_13[0][0]                     
__________________________________________________________________________________________________
conv5_1_1x1_reduce (Conv2D)     (None, 7, 7, 512)    524288      activation_40[0][0]              
__________________________________________________________________________________________________
conv5_1_1x1_reduce/bn (BatchNor (None, 7, 7, 512)    2048        conv5_1_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_41 (Activation)      (None, 7, 7, 512)    0           conv5_1_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv5_1_3x3 (Conv2D)            (None, 7, 7, 512)    2359296     activation_41[0][0]              
__________________________________________________________________________________________________
conv5_1_3x3/bn (BatchNormalizat (None, 7, 7, 512)    2048        conv5_1_3x3[0][0]                
__________________________________________________________________________________________________
activation_42 (Activation)      (None, 7, 7, 512)    0           conv5_1_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv5_1_1x1_increase (Conv2D)   (None, 7, 7, 2048)   1048576     activation_42[0][0]              
__________________________________________________________________________________________________
conv5_1_1x1_proj (Conv2D)       (None, 7, 7, 2048)   2097152     activation_40[0][0]              
__________________________________________________________________________________________________
conv5_1_1x1_increase/bn (BatchN (None, 7, 7, 2048)   8192        conv5_1_1x1_increase[0][0]       
__________________________________________________________________________________________________
conv5_1_1x1_proj/bn (BatchNorma (None, 7, 7, 2048)   8192        conv5_1_1x1_proj[0][0]           
__________________________________________________________________________________________________
add_14 (Add)                    (None, 7, 7, 2048)   0           conv5_1_1x1_increase/bn[0][0]    
                                                                 conv5_1_1x1_proj/bn[0][0]        
__________________________________________________________________________________________________
activation_43 (Activation)      (None, 7, 7, 2048)   0           add_14[0][0]                     
__________________________________________________________________________________________________
conv5_2_1x1_reduce (Conv2D)     (None, 7, 7, 512)    1048576     activation_43[0][0]              
__________________________________________________________________________________________________
conv5_2_1x1_reduce/bn (BatchNor (None, 7, 7, 512)    2048        conv5_2_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_44 (Activation)      (None, 7, 7, 512)    0           conv5_2_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv5_2_3x3 (Conv2D)            (None, 7, 7, 512)    2359296     activation_44[0][0]              
__________________________________________________________________________________________________
conv5_2_3x3/bn (BatchNormalizat (None, 7, 7, 512)    2048        conv5_2_3x3[0][0]                
__________________________________________________________________________________________________
activation_45 (Activation)      (None, 7, 7, 512)    0           conv5_2_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv5_2_1x1_increase (Conv2D)   (None, 7, 7, 2048)   1048576     activation_45[0][0]              
__________________________________________________________________________________________________
conv5_2_1x1_increase/bn (BatchN (None, 7, 7, 2048)   8192        conv5_2_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_15 (Add)                    (None, 7, 7, 2048)   0           conv5_2_1x1_increase/bn[0][0]    
                                                                 activation_43[0][0]              
__________________________________________________________________________________________________
activation_46 (Activation)      (None, 7, 7, 2048)   0           add_15[0][0]                     
__________________________________________________________________________________________________
conv5_3_1x1_reduce (Conv2D)     (None, 7, 7, 512)    1048576     activation_46[0][0]              
__________________________________________________________________________________________________
conv5_3_1x1_reduce/bn (BatchNor (None, 7, 7, 512)    2048        conv5_3_1x1_reduce[0][0]         
__________________________________________________________________________________________________
activation_47 (Activation)      (None, 7, 7, 512)    0           conv5_3_1x1_reduce/bn[0][0]      
__________________________________________________________________________________________________
conv5_3_3x3 (Conv2D)            (None, 7, 7, 512)    2359296     activation_47[0][0]              
__________________________________________________________________________________________________
conv5_3_3x3/bn (BatchNormalizat (None, 7, 7, 512)    2048        conv5_3_3x3[0][0]                
__________________________________________________________________________________________________
activation_48 (Activation)      (None, 7, 7, 512)    0           conv5_3_3x3/bn[0][0]             
__________________________________________________________________________________________________
conv5_3_1x1_increase (Conv2D)   (None, 7, 7, 2048)   1048576     activation_48[0][0]              
__________________________________________________________________________________________________
conv5_3_1x1_increase/bn (BatchN (None, 7, 7, 2048)   8192        conv5_3_1x1_increase[0][0]       
__________________________________________________________________________________________________
add_16 (Add)                    (None, 7, 7, 2048)   0           conv5_3_1x1_increase/bn[0][0]    
                                                                 activation_46[0][0]              
__________________________________________________________________________________________________
activation_49 (Activation)      (None, 7, 7, 2048)   0           add_16[0][0]                     
__________________________________________________________________________________________________
avg_pool (AveragePooling2D)     (None, 1, 1, 2048)   0           activation_49[0][0]              
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 2048)         0           avg_pool[0][0]                   
__________________________________________________________________________________________________
classifier (Dense)              (None, 8631)         17684919    flatten_1[0][0]                  
__________________________________________________________________________________________________
output_layer (Dense)            (None, 2)            17264       classifier[0][0]                 
==================================================================================================
Total params: 41,263,335
Trainable params: 41,210,215
Non-trainable params: 53,120
__________________________________________________________________________________________________
None
Train on 273 samples, validate on 118 samples
Epoch 1/3

 64/273 [======>.......................] - ETA: 3:02 - loss: 0.6932 - acc: 0.4688
128/273 [=============>................] - ETA: 1:53 - loss: 0.6931 - acc: 0.4531
192/273 [====================>.........] - ETA: 1:01 - loss: 0.6931 - acc: 0.4792
256/273 [===========================>..] - ETA: 12s - loss: 0.6930 - acc: 0.5312 
273/273 [==============================] - 215s 789ms/step - loss: 0.6930 - acc: 0.5421 - val_loss: 0.6922 - val_acc: 0.6864
Epoch 2/3

 64/273 [======>.......................] - ETA: 2:23 - loss: 0.6907 - acc: 0.7500
128/273 [=============>................] - ETA: 1:48 - loss: 0.6903 - acc: 0.8125
192/273 [====================>.........] - ETA: 1:06 - loss: 0.6900 - acc: 0.8177
256/273 [===========================>..] - ETA: 13s - loss: 0.6898 - acc: 0.8242 
273/273 [==============================] - 232s 849ms/step - loss: 0.6898 - acc: 0.8205 - val_loss: 0.6888 - val_acc: 0.7627
Epoch 3/3

 64/273 [======>.......................] - ETA: 2:25 - loss: 0.6864 - acc: 0.8125
128/273 [=============>................] - ETA: 1:40 - loss: 0.6856 - acc: 0.8672
192/273 [====================>.........] - ETA: 56s - loss: 0.6854 - acc: 0.8646 
256/273 [===========================>..] - ETA: 11s - loss: 0.6848 - acc: 0.8711
273/273 [==============================] - 202s 741ms/step - loss: 0.6847 - acc: 0.8645 - val_loss: 0.6832 - val_acc: 0.8136

 10/118 [=>............................] - ETA: 11s
 20/118 [====>.........................] - ETA: 10s
 30/118 [======>.......................] - ETA: 9s 
 40/118 [=========>....................] - ETA: 8s
 50/118 [===========>..................] - ETA: 7s
 60/118 [==============>...............] - ETA: 6s
 70/118 [================>.............] - ETA: 5s
 80/118 [===================>..........] - ETA: 4s
 90/118 [=====================>........] - ETA: 2s
100/118 [========================>.....] - ETA: 1s
110/118 [==========================>...] - ETA: 0s
118/118 [==============================] - 13s 106ms/step
[INFO] loss=0.6832, accuracy: 81.3559%
{'val_loss': [0.6921835077010979, 0.6887993499384089, 0.6832429928294683], 'val_acc': [0.686440669884116, 0.7627118532940492, 0.8135593280953876], 'loss': [0.6930137564847757, 0.6897561347091591, 0.6846756050874899], 'acc': [0.5421245432162023, 0.8205128213861487, 0.8644688653421926]}
